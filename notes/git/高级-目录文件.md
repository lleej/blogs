# 目录结构

> 配置库所有的信息都存储在`<workdir>/.git`目录中

```shell
$ ls -al
total 24
-rw-r--r--   1 lijie  staff    9 12 12 09:14 COMMIT_EDITMSG		# 最近一次提交时的消息内容
-rw-r--r--   1 lijie  staff   23 12 12 09:14 HEAD				# HEAD头指向的branch/commit
drwxr-xr-x   2 lijie  staff   64 12 12 09:14 branches			# branch存放的目录
-rw-r--r--   1 lijie  staff  144 12 12 09:24 config				# local配置信息
-rw-r--r--   1 lijie  staff   73 12 12 09:14 description		# 
drwxr-xr-x  12 lijie  staff  384 12 12 09:14 hooks
-rw-r--r--   1 lijie  staff  118 12 12 09:14 index				# 暂存区
drwxr-xr-x   3 lijie  staff   96 12 12 09:14 info				# 可以存放项目的忽略文件配置
drwxr-xr-x   4 lijie  staff  128 12 12 09:14 logs				# 操作日志
drwxr-xr-x   4 lijie  staff  128 12 12 09:14 objects			# 文件快照存储的目录
drwxr-xr-x   4 lijie  staff  128 12 12 09:14 refs				# heads和tags存放的目录
```

新创建的空配置库中，目录结构是完整的，但没有任何的`branch`、`tag`、`commit`、`tree`、`blob`文件

## COMMIT_EDITMSG文件

初始化的配置库中，不存在该文件。

在本地使用`git commit -m'消息内容'`后，保存最后一次提交的消息内容

## HEAD文件

HEAD 保存当前操作的`branch`或`commit`，内容如下

```shell
$ cat HEAD
ref: refs/heads/master
```

注：当前指向的是`master`分支

如果`HEAD`指向的是一个`commit id`而不是`branch`，则系统会提示`detached HEAD`警告。

##branches目录



## config文件

配置库私有的配置文件。文件内容如下：

```shell
$ cat config
[core]
	repositoryformatversion = 0
	filemode = true
	bare = false
	logallrefupdates = true
	ignorecase = true
	precomposeunicode = true
[user]
	name = lijie
	email = lijie@boco.com.cn
```

注：由于设置了库作用域的用户信息`git config --local`，因此`[user]`中有相关的信息。



## Index 文件

`index`指的是`git`的暂存区，用于存放数据文件的索引。

- 所有`git add `指令添加/删除/更改的文件，都存放在暂存区中
- 通过`git clone`指令复制的仓库，暂存区中保存的是`HEAD`指针指向`branch`的所有文件

```shell
# 使用 git ls-files -s 查看暂存区中的文件
$ git ls-files -s
100644 ca028fbbadceb5991f1d554e3d521baac5977f78 0	1.md
100644 9a61029c3d46030edb0c85a6e99e98ffd510fcc8 0	second.md
100644 8672c74c0922bc3fbb5e4743ddc98f761ef6d26e 0	three.md
```



## objects目录

存放`object`对象的目录，`object`对象包括`commit`、`tree`、`blob`。其中的`blob`对象存储的就是压缩的文件快照。

注：`object`文件的文件名全部采用`SHA-1`计算的哈希值，长度为 40 。

```shell
$ ls -l
total 0
drwxr-xr-x  3 lijie  staff  96 12 12 16:09 15
drwxr-xr-x  3 lijie  staff  96 12 12 17:56 5d
drwxr-xr-x  3 lijie  staff  96 12 12 16:09 6d
drwxr-xr-x  3 lijie  staff  96 12 12 16:04 80
drwxr-xr-x  3 lijie  staff  96 12 12 16:07 e6
drwxr-xr-x  2 lijie  staff  64 12 12 09:14 info
drwxr-xr-x  2 lijie  staff  64 12 12 09:14 pack
```

###pack目录

当存储`object`对象的目录过于凌乱时，会将部分目录进行打包处理。处理后放在此目录中

###info目录

###其他目录

用于存放`commit`、`tree`、`blob`类型的`git`文件

- 目录名：文件名的前 2 位
- 文件名：文件名后 38 位

因此，对文件进行处理时，需要将两部分拼接后才是真正的文件名。

```shell
# 进入 15 目录
$ cd 15

# 查看文件
$ ls
6aa60400c19d00a4d8bcef1ad0ed5a846e9849
```



## refs目录

存放仓库使用的`branch`和`tag`信息

```shell
$ ls -l
total 0
drwxr-xr-x  3 lijie  staff  96 12 12 16:09 heads
drwxr-xr-x  2 lijie  staff  64 12 12 09:14 tags
```

###heads目录

存放分支信息

```shell
$ ls -l
total 8
-rw-r--r--  1 lijie  staff  41 12 12 16:09 master
```

###tags目录

存放标签信息

```shell
$ ls -l
total 8
-rw-r--r--  1 lijie  staff  41 12 13 18:24 v1.0
```







