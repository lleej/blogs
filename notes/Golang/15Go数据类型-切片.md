title: 15.Go语言学习笔记-Go复杂数据类型-切片
date: 2020-04-24
tags: Go
categories: Go语言
layout: post

------

摘要：本节介绍`Go`语言的复杂数据类型：切片。关键字：变长、同构元素

<!-- more -->

## 切片

`Slice`（切片）代表变长的序列，序列中每个元素都有相同的类型

切片声明的书写格式：`[]元素类型`，语法和数组很像，只是没有固定长度而已

切片类型的数据结构包含三部分

- 指针，指向第一个`slice`元素对应底层数组元素的地址
- 长度，`slice`中元素的数量，长度不能大于容量
- 容量，从`slice`的开始位置到底层数组结尾元素的长度

![img](.\assets\godata3.png)

```go
var x = []int{2, 3, 5, 7, 11}
var y = x[1:3]
fmt.Printf("%T\t%T", x, y)	// []int	[]int
fmt.Println(y, len(y), y[0], y[1])	// [3, 5]  2  3  5
fmt.Println(y[3])	// runtime error: index out of range [3] with length 2
fmt.Println(y[0:4]) // [3, 5, 7, 11]
```

如果切片操作`[[start]:[stop]]`超出`cap(s)`的上限将导致一个`panic`异常，但是超出`len(s)`则是意味着扩展了`slice`，因为新`slice`的长度会变大

多个`slice`之间可以共享底层的数据，并且引用的数组部分区间可能重叠

![img](.\assets\ch4-01.png)

```go
months := [...]string{1: "January", /* ... */, 12: "December"}
Q2 := months[4:7]
summer := months[6:9]
fmt.Println(Q2)     // ["April" "May" "June"]
fmt.Println(summer) // ["June" "July" "August"]
```

因为`slice`值包含指向第一个`slice`元素的指针，因此向函数传递`slice`将允许在函数内部修改底层数组的元素

```go
func reverse(s []int) {
	for i, j := 0, len(s)-1; i < j; i, j = i+1, j-1 {
		s[i], s[j] = s[j], s[i]
	}
}

a := [...]int{0, 1, 2, 3, 4, 5}	// 数组类型，底层数据存储
reverse(a[:])	// 传入切片，底层共享a数组，处理的是a数组中的数据
fmt.Println(a)	// "[5 4 3 2 1 0]"

```



