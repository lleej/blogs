title: 40.Go并发之基础
date: 2020-05-13
tags: Go
categories: Go语言
layout: post

------

摘要：本节介绍`Go`语言中并发的一些基本知识

<!-- more -->

并发：指同时进行多个任务的程序。例如：`Web`服务可以处理成千上万的请求，页面可以边渲染、边响应输入、边发送请求等，随着计算机硬件的发展（多核、多线程）以及互联网的发展，并发程序越来越重要

`Go`语言中的并发程序可以用两种手段来实现：

- 传统模式：多线程共享内存
- 现代模式：顺序通信进程`CSP（communicating sequential processes）`

`Go`的并发有些类似于`Python`的协程，其并发性能和数量远远优于传统的并发模式。并发的良好支持也是`Go`语言被众多大厂重视和应用的原因之一

## Goroutines

在`Go`语言中，每个并发的执行单元叫作`goroutine`

在一个线性的程序中，代码是严格按顺序依次执行的，前面的没有执行完，是不会执行后面的

主函数`main()`是在一个单独的称为`main goroutine`中执行，也就是说每个可执行程序至少有一个`goroutine`

使用`go`关键字会创建一个新的`goroutine`，语句中的函数/方法将在这个新的`goroutine`中执行，`go`语句本身会迅速完成，不会挂起等待其执行完毕

```go
f()    // call f(); wait for it to return
go f() // create a new goroutine that calls f(); don't wait
```

### 退出

创建`goroutine`使用`go`语句，但如何控制其退出呢？

- 主函数`main()`正常退出
- 终止程序`os.Exit(1)`
- 通过`Channels`实现通信

